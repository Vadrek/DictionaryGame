(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[213],{7380:function(e,t,n){Promise.resolve().then(n.bind(n,1411))},1411:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var r=n(7437),o=n(2265);let c=new class{onInitBoard(e,t){e.on("init_board",e=>{t(e)})}movePlayer(e,t){e.emit("move_player",t)}onUpdatePlayers(e,t){e.on("update_players",e=>{t(e)})}onUpdateBoard(e,t){e.on("update_board",e=>{t(e)})}},a=e=>Math.round(100*e)/100,i=(e,t)=>{let n=document.getElementById(e);n&&(n.style.backgroundColor=t)},l=(e,t)=>{let{text:n,x:r,y:o}=t;e.beginPath(),e.font="20px Arial",e.textAlign="left",e.textBaseline="top",e.fillStyle="black",e.fillText(n,r,o),e.stroke()};n(6751);var u=n(9233),s=n.n(u),d=n(4036);function f(e){let{socket:t}=e,n=(0,o.useRef)(null),u={},s=(0,o.useRef)(0),d=(0,o.useRef)(0),f=(0,o.useRef)(0),h=(0,o.useRef)(0),m=(0,o.useRef)(0),p=(0,o.useRef)(0),[v,g]=(0,o.useState)([]),x=()=>{t&&(u.ArrowUp&&c.movePlayer(t,{direction:"UP"}),u.ArrowDown&&c.movePlayer(t,{direction:"DOWN"}),u.ArrowLeft&&c.movePlayer(t,{direction:"LEFT"}),u.ArrowRight&&c.movePlayer(t,{direction:"RIGHT"}))};return(0,o.useEffect)(()=>{n.current&&(s.current=n.current.offsetWidth,d.current=n.current.offsetHeight,n.current.width=n.current.offsetWidth,n.current.height=n.current.offsetHeight,t&&c.onInitBoard(t,e=>{g(e),m.current=e.length,p.current=e[0].length,f.current=a(s.current/e[0].length/10),h.current=a(d.current/e.length/10)}))},[]),(0,o.useEffect)(()=>{document.addEventListener("keydown",function(e){u[e.code]=!0}),document.addEventListener("keyup",function(e){delete u[e.code]})}),(0,o.useEffect)(()=>{let e=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let e=arguments.length>1?arguments[1]:void 0;for(let t=0;t<e.length;t++)for(let n=0;n<e[0].length;n++)i("".concat(t,"-").concat(n),e[t][n].color)},r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.clearRect(0,0,e.canvas.width,e.canvas.height),t.forEach(function(t){let{x:n,y:r,size:o,color:c}=t;e.arc(n,r,o/2,0,2*Math.PI),e.beginPath();let a=(n-o/2)*f.current,i=(r-o/2)*h.current;e.rect(a,i,o*f.current,o*h.current),e.fillStyle=c,e.fill(),l(e,{x:a,y:i,text:"x=".concat(n," y=").concat(r)})})};if(t&&n.current){let o=n.current.getContext("2d");o&&c.onUpdateBoard(t,t=>{let{players:n,board:c}=t;r(o,n),e(n,c)})}},[]),(0,o.useEffect)(()=>{let e;let t=()=>{x(),e=window.requestAnimationFrame(t)};return t(),()=>{window.cancelAnimationFrame(e)}},[x]),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"container",children:[v.map((e,t)=>(0,r.jsx)("div",{className:"test-row",children:e.map((e,n)=>(0,r.jsx)("div",{id:t.toString()+"-"+n.toString(),className:"test-square",style:{backgroundColor:e.color}},t.toString()+"-"+n.toString()))},t)),(0,r.jsx)("canvas",{className:"canvas",ref:n},"my-canvas")]})})}var h=function(){let e=(0,d.h)();return(0,r.jsxs)("div",{className:s().appContainer,children:[(0,r.jsx)("h1",{className:s().welcomeText,children:"welcomeText"}),(0,r.jsx)("div",{className:s().mainContainer,children:(0,r.jsx)(f,{socket:e})})]})}},4036:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var r=n(3388),o=n(2601);let c=null,a=()=>{if(!c){let e=o.env.NEXT_PUBLIC_API_URL||"http://localhost:9000";c=(0,r.io)(e)}return c}},6751:function(){},9233:function(e){e.exports={appContainer:"App_appContainer__PRCNs",welcomeText:"App_welcomeText__dJH0r",mainContainer:"App_mainContainer__QA9eR"}}},function(e){e.O(0,[927,971,596,744],function(){return e(e.s=7380)}),_N_E=e.O()}]);